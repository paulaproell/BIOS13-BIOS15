# Plot the last generated walk alone
plot(0:tmax, n, type = "l")
#Plot every column as a line
matplot(m, type = "l", lty = 1, col = rainbow(rep),
xlab = "time", ylab = "value",
main = "Random Walks")
#Explore variables
model1 <- glm(total_seedlings ~ Distance_to_Eucalypt_canopy.m. + PET + MrVBF,family="poisson",data=dat3)
source("C:/Users/pauli/Desktop/Lund/Uni/Animal Ecology/R - Processing and Analysis of Biological Data/Midterm exercise/Midterm_exercise_PP.R")
summary(model2)
model2 <- glm.nb(total_seedlings ~  Distance_to_Eucalypt_canopy.m. + PET +
MrVBF,data=dat3)
summary(model2)
#Summary statistics
#Calculating exp(β) values
exp(coefs[1,1])
exp(coefs[2,1])
exp(coefs[3,1])
#Summary statistics
#Calculating exp(β) values
coefs = summary(model2)$coef
exp(coefs[1,1])
exp(coefs[2,1])
exp(coefs[3,1])
exp(coefs[4,1])
model2 <- glm.nb(total_seedlings ~  Distance_to_Eucalypt_canopy.m. + PET +
MrVBF,data=dat3)
summary(model2)
exp(coefs[1,1])
exp(coefs[1,1])
exp(coefs[2,1])
exp(coefs[3,1])
exp(coefs[4,1])
#Calculate pseudo R^2
1 - model2$deviance/model2$null.deviance
#Mean and range of response variable
mean(dat3$total_seedlings)
range(dat3$total_seedlings)
#Explore effect of variables
exp(coefs[1,1]) #Seedling abundance when all other predictors =0
exp(coefs[1,1] + coefs[2,1] * mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE))
exp(coefs[1,1] + coefs[3,1] * mean(dat3$PET, na.rm = TRUE))
exp(coefs[1,1] + coefs[4,1] * mean(dat3$MrVBF, na.rm = TRUE))
#Make graphs with different variables
#Distance to Eucalyptus canopy
ggplot(dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings)) +
geom_point(size=3, color="darkgreen") +
labs(x = "Distance to Eucalyptus canopy", y = "Total seedlings") +
theme_classic()
newdec <- seq(min(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
max(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
length.out = 65)
neweuc <- rep(mean(dat3$total_seedlings), length(newdec))
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = newdec,
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()
# Create newdata with PET varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = newPET,
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
# Predict on response scale
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = PET, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = PET, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = PET, ymin = lower, ymax = upper),
fill = "orange", alpha = 0.4) +
labs(x = "Potential Evapotranspiration (PET)", y = "Total seedlings") +
theme_classic()
# Create newdata with MrVBF varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = newMrVBF
)
# Create newdata with MrVBF varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = newMrVBF
)
# Predict on response scale
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic()
# Explore range of precipitation
range(dat3$precipitation_coldest_quarter, na.rm = TRUE)
# Create sequence of precipitation values
newPrec <- seq(min(dat3$precipitation_coldest_quarter, na.rm = TRUE),
max(dat3$precipitation_coldest_quarter, na.rm = TRUE),
length.out = 65)
#Make predictions with Distance to eucalyptus canopy
range(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE)  #explore range ignoring NA's
newdec <- seq(min(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
max(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
length.out = 65)
neweuc <- rep(mean(dat3$total_seedlings), length(newdec))
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = newdec,
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()
# Explore range of PET
range(dat3$PET, na.rm = TRUE)  # explore range ignoring NA's
# Create sequence of PET values
newPET <- seq(min(dat3$PET, na.rm = TRUE),
max(dat3$PET, na.rm = TRUE),
length.out = 65)
# Create newdata with PET varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = newPET,
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
# Predict on response scale
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = PET, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = PET, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = PET, ymin = lower, ymax = upper),
fill = "orange", alpha = 0.4) +
labs(x = "Potential Evapotranspiration (PET)", y = "Total seedlings") +
theme_classic()
# Explore range of MrVBF
range(dat3$MrVBF, na.rm = TRUE)
# Create sequence of MrVBF values
newMrVBF <- seq(min(dat3$MrVBF, na.rm = TRUE),
max(dat3$MrVBF, na.rm = TRUE),
length.out = 65)
# Create newdata with MrVBF varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = newMrVBF
)
# Predict on response scale
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic()
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic() +
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 14),
axis.text.y  = element_text(size = 14)
)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic() +
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
#Make predictions with Distance to eucalyptus canopy
range(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE)  #explore range ignoring NA's
newdec <- seq(min(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
max(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
length.out = 65)
neweuc <- rep(mean(dat3$total_seedlings), length(newdec))
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = newdec,
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
# Explore range of PET
range(dat3$PET, na.rm = TRUE)  # explore range ignoring NA's
# Create sequence of PET values
newPET <- seq(min(dat3$PET, na.rm = TRUE),
max(dat3$PET, na.rm = TRUE),
length.out = 1400)
# Create newdata with PET varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = newPET,
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
# Predict on response scale
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = PET, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = PET, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = PET, ymin = lower, ymax = upper),
fill = "orange", alpha = 0.4) +
labs(x = "Potential Evapotranspiration (PET)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
# Explore range of MrVBF
range(dat3$MrVBF, na.rm = TRUE)
# Create sequence of MrVBF values
newMrVBF <- seq(min(dat3$MrVBF, na.rm = TRUE),
max(dat3$MrVBF, na.rm = TRUE),
length.out = 9)
# Create newdata with MrVBF varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = newMrVBF
)
# Predict on response scale
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic() +
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
range(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE)  #explore range ignoring NA's
newdec <- seq(min(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
max(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
length.out = 65)
neweuc <- rep(mean(dat3$total_seedlings), length(newdec))
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = newdec,
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = Distance_to_Eucalypt_canopy.m., y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = Distance_to_Eucalypt_canopy.m., ymin = lower, ymax = upper),
fill = "darkgreen", alpha = 0.4) +
labs(x = "Distance to Eucalyptus canopy (m)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
max(dat3$PET, na.rm = TRUE)
# Create sequence of PET values
newPET <- seq(min(dat3$PET, na.rm = TRUE),
# Create newdata with PET varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = newPET,
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
# Predict on response scale
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = PET, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = PET, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = PET, ymin = lower, ymax = upper),
fill = "orange", alpha = 0.4) +
labs(x = "Potential Evapotranspiration (PET)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
range(dat3$PET, na.rm = TRUE)  # explore range ignoring NA's
# Create sequence of PET values
newPET <- seq(min(dat3$PET, na.rm = TRUE),
max(dat3$PET, na.rm = TRUE),
length.out = 1400)
# Create newdata with PET varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = newPET,
MrVBF = mean(dat3$MrVBF, na.rm = TRUE)
)
# Predict on response scale
y_hat <- predict(model2, newdata = newdata, type = "response")
# Get predictions on link scale with standard errors
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)          # predicted counts
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = PET, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = PET, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = PET, ymin = lower, ymax = upper),
fill = "orange", alpha = 0.4) +
labs(x = "Potential Evapotranspiration (PET)", y = "Total seedlings") +
theme_classic()+
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
range(dat3$MrVBF, na.rm = TRUE)
# Create sequence of MrVBF values
newMrVBF <- seq(min(dat3$MrVBF, na.rm = TRUE),
max(dat3$MrVBF, na.rm = TRUE),
length.out = 9)
# Create newdata with MrVBF varying, other predictors at mean
newdata <- data.frame(
Distance_to_Eucalypt_canopy.m. = mean(dat3$Distance_to_Eucalypt_canopy.m., na.rm = TRUE),
PET = mean(dat3$PET, na.rm = TRUE),
MrVBF = newMrVBF
)
# Predict on response scale
pred_link <- predict(model2, newdata = newdata, type = "link", se.fit = TRUE)
# Compute 95% CI on response scale
newdata$predicted <- exp(pred_link$fit)
newdata$lower <- exp(pred_link$fit - 1.96*pred_link$se.fit)
newdata$upper <- exp(pred_link$fit + 1.96*pred_link$se.fit)
# Plot
ggplot() +
geom_jitter(data = dat3, aes(x = MrVBF, y = total_seedlings),
width = 0.1, alpha = 0.6, color = "grey30") +
geom_line(data = newdata, aes(x = MrVBF, y = predicted), color = "black", size = 1.2) +
geom_ribbon(data = newdata, aes(x = MrVBF, ymin = lower, ymax = upper),
fill = "brown", alpha = 0.4) +
labs(x = "Flatness Index (MrVBF)", y = "Total seedlings") +
theme_classic() +
theme(
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12)
)
#Explore variables
model1 <- glm(total_seedlings ~ Distance_to_Eucalypt_canopy.m. + PET + MrVBF,family="poisson",data=dat3)
summary(model1)
model2 <- glm.nb(total_seedlings ~  Distance_to_Eucalypt_canopy.m. + PET +
MrVBF,data=dat3)
summary(model2)
